name: Update Repository Stats in README

on:
  schedule:
    - cron: '0 0 * * *'  # اجرا هر روز ساعت 00:00
  workflow_dispatch:      # امکان اجرای دستی

jobs:
  update-readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Get repository stats
        id: stats
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          REPO="${{ github.repository }}"
          
          # تعداد کلون‌ها
          CLONES=$(curl -s -H "Authorization: token $GITHUB_TOKEN" https://api.github.com/repos/$REPO/traffic/clones | jq '.count')
          
          # تعداد بازدیدها
          VIEWS=$(curl -s -H "Authorization: token $GITHUB_TOKEN" https://api.github.com/repos/$REPO/traffic/views | jq '.count')
          
          # تعداد ستاره‌ها
          STARS=$(curl -s -H "Authorization: token $GITHUB_TOKEN" https://api.github.com/repos/$REPO | jq '.stargazers_count')
          
          echo "::s
